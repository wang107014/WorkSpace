#体检



##一、个人预约
	zw ^websys.MenuD(51503)
	dhcpepreiadm.main.csp
	dhcpepreiadm.main.hisui.js
	
	1、登记号回车
	    dhcpepreiadm.main.hisui.js中的RegNoOnChange方法中
		赋值
		dhcpepreiadm.main.hisui.js中的SetHisInfo方法中

	2、输入证件号回车是会调用一下方法来根据证件号和科室查找UseID和SetsID

		dhcpepreiadm.main.hisui.js中的FindPreInfoByIDCard方法中
		w ##class(web.DHCPE.NetPre.GetPreInfo).GetInfo("530323198009080031","117")
		
		s ID=$O(^User.DHCPENetPreRecordI("IDCardIndex",IDCard,ID),-1)
		s Status=$LG(^User.DHCPENetPreRecordD(ID),7)
		q:Status'="0"   //Status为0才会有UseID和SetsID
		s UseID=ID
		s SetsID=$LG(^User.DHCPENetPreRecordD(UseID),8)


	3、点预约按钮

		1 、dhcpepreiadm.main.hisui.js中的Save方法中先获取参数(网上预约后未被HIS处理前,参数中会有UseID和SetsID)
	
		2、再调这个##class(web.DHCPE.PreIADM).HISUISave("...")
		在这个方法中会先在个人ADM表(DHC_PE_PreIADM)中新增一条记录信息，产生一个rowid,如果参数中存在UseID和SetsID,则会把网上预约的套餐信息存储在在个人项目表(DHC_PE_PreIOrdItem)中，参数中没有存在UseID和SetsID，则不会存储信息在个人项目表中。
	
		3、个人信息表中有没有信息，则体现在体检项目中有没有信息。

	4、点击清屏
		dhcpepreiadm.main.hisui.js中的Clear_click方法中

###1、一些选择框

	1、婚姻状况
	d ##class(%ResultSet).RunQuery("web.DHCPE.HISUICommon","FindMarried")

	2、体检类别
	d ##class(%ResultSet).RunQuery("web.DHCPE.HISUICommon","FindPatFeeType")

	3、VIP等级
	d ##class(%ResultSet).RunQuery("web.DHCPE.HISUICommon","FindVIP")

	4、证件类型
	d ##class(%ResultSet).RunQuery("web.DHCPE.HISUICommon","FindPAPMICardType")

###2、体检套餐

	d ##class(%ResultSet).RunQuery("web.DHCPE.HandlerOrdSetsEx","queryOrdSet","","ItemSet","","")
	
	1、点击预览
	dhcpepreiadm.main.hisui.js中的openSetWin方法中
	项目信息列表
	d ##class(%ResultSet).RunQuery("web.DHCPE.Query.PreItemList","QueryPreItemList","3350","Ord","","","","","")

	2、双击事件
	onDblClickRow
	


###3、检查列表
	d ##class(%ResultSet).RunQuery("web.DHCPE.StationOrder","StationOrderList","","Item","PreItemList","","")

	1、点击操作
	dhcpepreiadm.main.hisui.js中的AddItem方法中

###4、检验列表

	d ##class(%ResultSet).RunQuery("web.DHCPE.StationOrder","StationOrderList","","Lab","PreItemList","","")

###5、其他项目

	d ##class(%ResultSet).RunQuery("web.DHCPE.StationOrder","StationOrderList","","Other","PreItemList","","")

###6、药品列表

	d ##class(%ResultSet).RunQuery("web.DHCPE.StationOrder","StationOrderList","","Medical","PreItemList","","")

###7、体检项目

	d ##class(%ResultSet).RunQuery("web.DHCPE.Query.PreItemList","QueryPreItemList","11061","PERSON","PRE","Item","ItemSet","","")
	1、点击删除
	dhcpepreiadm.main.hisui.js中的DeleteItemSet方法中


###8、点击预约保存信息

	
	dhcpepreiadm.main.hisui.js中的Save方法中
	1、没有团体信息时
	w ##class("web.DHCPE.PreIADM").HISUISave("","","^9435^^^2018-11-29^2018-11-29^^^PREREG^N^N^N^^N^N^^DC^ID^1^^^^^^^^^0^0^^^^^^N^5$$^","","")
	2、有团体信息时
	w ##class(web.DHCPE.PreIADM).InsertIADMInGTeam()


###9、点击登记

	dhcpepreiadm.main.hisui.js中的Register方法中
	w ##class(web.DHCPE.DHCPEIAdm).UpdateIADMInfo("11069","2",1,"",1)



##二、个人预约查询

###1、点击查询

	DHCPEPreIADM.Find.js中的BFind_click方法中
	d ##class(%ResultSet).RunQuery("web.DHCPE.PreIADM","SearchPreIADM","","","64953","^","","","","","64962","","","","^","","1","")


###2、修改VIP等级

	//体检人员表
	SELECT IADM_CRMADM, * FROM DHC_PE_IADM WHERE IADM_PAADM_DR=69
	//预约个人ADM表(VIP等级)
	SELECT PIADM_Vip, * FROM DHC_PE_PreIADM WHERE PIADM_RowId=10953
	
	DHCPEPreIADM.Find.js中的BUpdateVIPLevel_click方法中
	w ##class(web.DHCPE.PreItemListEx).ChangeVipLevel("69","2")


###3、指引单预览

	DHCPEPreIADM.Find.js中的PatItemPrintXH方法中
	w ##class(web.DHCPE.Query.IAdmItemStatus).GetPatOrdItemInfo("","","69^1^PAADMY","N")

	获取导检单信息：w ##class(web.DHCPE.PrintNewDirect).GetPrintInfo("708^^CRM")

	打印
	DHCPEIAdmItemStatusAdms.PatItemPrint.js中的Print方法中
	xml模板：OEItemPrintA4
	DHCPEIAdmItemStatusAdms.PatItemPrint.js中的PrintA4方法中



###4、报告预览

	DHCPEPreIADM.Find.js中的PreviewAllReport方法中

###5、补打收费条码

	DHCPEPreIADM.Find.js中的PrintPayAagin_Click方法中
	打印
	DHCPEPrintBarCommon.js中的PrintBarRis方法中


###6、修改部门

	//预约个人ADM表
	SELECT PIADM_PIBI_DR, * FROM DHC_PE_PreIADM WHERE PIADM_RowId=11069

	//个人基本信息表(职位)
	SELECT PIBI_Position, * FROM DHC_PE_PreIBaseInfo WHERE PIBI_RowId='9438'
	
	DHCPEPreIADM.Find.js中的BUpdateDepart_click方法中
	w ##class(web.DHCPE.PreIADMEx).UpdateDepartName("11069","吏部")



###7、修改预约项目

	DHCPEPreIADM.Find.js中的BModifyTest_click方法中
	
1、加项界面

	dhcpepreitemlist.main.csp
	d ##class(%ResultSet).RunQuery("web.DHCPE.Query.PreItemList","QueryPreItemList","11075","PERSON","ADD","","ItemSet","","")

	1、确认加项医嘱
	DHCPEPreItemList.js中的ConfirmOrdItem_Click方法中
	点击确认加项时会在DHC_PE_CRMOrder(与CRM大项对照表)新增记录信息
	
	2、收费弹框
	DHCPEPreItemList.js中的OpenCharge方法中
	dhcpepreauditpay.csp
	结算费用明细
	w ##class(%ResultSet).RunQuery("web.DHCPE.PreAudit","SerchPreAudit","I","","5701","Fee","")
	
	3、审核表对应医嘱明细
	w ##class(%ResultSet).RunQuery("web.DHCPE.ItemFeeList","FindItemFeeList","","","24131","","","","","","","")

2、套餐查询

	d ##class(%ResultSet).RunQuery("web.DHCPE.HandlerOrdSetsEx","queryOrdSet","","ItemSet","11075","PreItemList")


3、医嘱查询(item)

	d ##class(%ResultSet).RunQuery("web.DHCPE.StationOrder","StationOrderList","","Item","PreItemList","11075","")

4、医嘱查询(Lab)

	d ##class(%ResultSet).RunQuery("web.DHCPE.StationOrder","StationOrderList","","Lab","PreItemList","11075","")



###8、点击收费状态链接

	w ##class(%ResultSet).RunQuery("web.DHCPE.PreAudit","SerchPreAudit","I","11069","","","")

1、项目明细

	w ##class(%ResultSet).RunQuery("web.DHCPE.ItemFeeList","FindItemFeeList","","","24115","","","","","","","")

2、拆分项目

	dhcpe2feelist.csp
	移动选择项
	DHCPEMove.js中的MoveToR_clicked方法中

3、点击打印交款单

	DHCPEPreAudit.List.js中的BPrint_click方法中


###9、点击开始日期

	1、更新日期
	DHCPEUpdateCheckDate.js中的BUpdate_click
	zw ##class(web.DHCPE.TransAdmInfo).UpdateAdmDate("12483","29/12/2018")


###10、点击打印

	DHCPEPreIADM.Find.js中的BPrint方法中
	DHCPEPrintCommon.js中的PrintAllApp方法中打印指引单
	DHCPEPrintCommon.js中的SpecItemPrintNew方法中打印检查条码
	w ##class(web.DHCPE.Query.IAdmItemStatus).GetPrintItem("328","",0)  获取检查条码的数据

	打印导检单 GetOEOrdItemBox
	DHCPEPrintCommon.js中的PatItemPrint()
	获取导检单信息：w ##class(web.DHCPE.PrintNewDirect).GetPrintInfo("708^^CRM")

###11、点击列表中的打印检验条码

	w ##class(web.DHCPE.PrintIAdmInfo).OutMyUI("328")

	1、点击打印全按钮:DHCPEPrintIAdmInfo.js中的PrintAllBarCode()
		打印化验条码:	DHCPEPrintCommon.js中BarCodePrint()
		检查条码:DHCPEPrintCommon.js中SpecItemPrintLCT() 


	w ##class(web.DHCPE.Query.IAdmItemStatus).GetPrintItem("264","255||1",0)

	2、单独打印条码
	DHCPEPrintIAdmInfo.js中的PrintBarCodeTJ
	 2.1、检验条码
		w ##class(web.DHCPE.BarPrint).GetPatOrdItemInfo("","",InString,AllowUnPayed,BDFlag,OrderFlag)
	 2.2、检查条码
        w ##Class(web.DHCPE.Query.IAdmItemStatus).GetPrintItem("3697","3346||9","0")

	通过就诊号和医嘱号查询医嘱加项类型
	w ##Class(web.DHCPE.PrintIAdmInfo).GetAddItem(212,"202||7")


###12、导出个人预约信息
	DHCPEPreIADM.Find.js中的Export_click方法中



##三、网上预约查询

	1、w ##class(%ResultSet).RunQuery("web.DHCPE.NetPre.PreFind","SerchPreInfo","64983","64989","")



##团体基本信息维护

	w ##class(%ResultSet).RunQuery("web.DHCPE.PreGBaseInfo","SearchPreGBaseInfo","","","","")

1、点击团体编码

	DHCPEPreGBaseInfo.Edit.js中的FindPatDetail方法中



##团体预约

1、团体名称

	w ##class(%ResultSet).RunQuery("web.DHCPE.PreGBaseInfo","SearchGListByDesc","")

2、点击更新

	DHCPEPreGADM.Edit.js中的Update方法中。
	w ##class(web.DHCPE.PreGADM).Save2("","","301^167^2018-12-16^2018-12-19^^^^Y^Y^Y^900^N^N^^DC^IS^ID^^王文正团队自费的体检报告^^^^^^^1^0^^")

3、团体分组

	点击存为预置
	DHCPEPreGTeam.Edit.js中的SaveTemplate方法中
	w ##class("web.DHCPE.PreGTeam","GTeamTempSet","文正分组4^90^67^N^M","","Set")

	点击更新
	DHCPEPreGTeam.Edit.js中的Update_click方法中
	d ##Class(web.DHCPE.PreGTeam).Save2("","","304^^^文正分组4^2018-12-10^2018-12-10^^^N^N^^N^N^^N^90^67^M^1^^^^GD^^^5")


	分组列表信息
	d ##class(%ResultSet).RunQuery("web.DHCPE.PreGTeam","SearchGTeam","304")
	
	复制分组
	DHCPEPreGTeam.List.js中的BCopyTeam_click方法中
	w ##class(web.DHCPE.PreGTeam).CopyTeamData("304||2","")

	快速分组
	DHCPEPreGTeamNew.js中的Update_click方法中
	w ##class(web.DHCPE.PreGTeamNew).Save2("","","304^^^女小于45岁^2018-12-10^2018-12-18^14:09^^N^N^^N^N^^F^45^0^N^2^^6^^GD")

	删除分组
	DHCPEPreGTeamNew.js中的Delete_click方法中
	w ##Class(web.DHCPE.PreGTeam).Delete("","","304||14")

	点击新建人员
	DHCPEPreIADM.Team.js中的BNewIADM方法中
	w ##class(web.DHCPE.PreIADM).InsertIADMInGTeam("9428","292","292||1","")

	选取已预约人员
	查询 zw ##class(%ResultSet).RunQuery("web.DHCPE.SelectPreInfo","SearchPreIADM","020000000044","","304||11")
	新增 w ##class(web.DHCPE.SelectPreInfo).InsertPreToTeam("134||2", 1531)

	点击查询项目列表
	d ##class(%ResultSet).RunQuery("web.DHCPE.Query.PreItemList","QueryPreItemList","11107","PERSON","","","","","")

	获取团体组的人员列表
	d ##class(%ResultSet).RunQuery("web.DHCPE.PreIADM","SearchGTeamIADM","482||1","","","","E","")

##团体预约查询

	列表
	d ##class(%ResultSet).RunQuery("web.DHCPE.PreGADM","SearchPreGADM","","王文东团体-测一下","","","","^PREREG^REGISTERED^ARRIVED","","","0","64992","64992","1","","","","")

	点击已检明细
	d ##class(%ResultSet).RunQuery("web.DHCPE.PreGADM","HadCheckedList","359","Y","","","")

	点击起始日期
	d ##class(%ResultSet).RunQuery("web.DHCPE.GAdmRecordManager", "FindGAdmRecord","360")

	点击取消预约(DHC_PE_PreGADM表中的PGADM_Status字段为CANCELPREREG)
	DHCPEPreGADM.Find.js中的BCancelPre方法中
	w ##class(web.DHCPE.PreGADM).UpdateStatus("361","CANCELPREREG")
	再次预约
	w ##class(web.DHCPE.PreGADM).UpdateStatus("366","PREREG")

	点击主场团体
	DHCPEPreGADM.Find.js中的HomeSet_Click方法中
	更新
	w ##class("web.DHCPE.PreHome").UpdateMethod("363^G","","2018-12-09","2018-12-10","30-35","")
	点击时段信息
	d ##class(%ResultSet).RunQuery("web.DHCPE.PreTemplate","SerchTimeInfo","H","3")
	更新时段信息
	DHCPEPreTemplateTime.js的BUpdate方法中
	w ##class(web.DHCPE.PreTemplate).UpdateTimeInfo("H","3","","12:00:00^13:00:00^2^3")
	删除时段信息
	DHCPEPreTemplateTime.js的BDelete_click方法中
	w ##class(web.DHCPE.PreTemplate).DeleteTimeInfo("H","3||2501")

	点击打印人员名单
	DHCPEPreGADM.Find.js中的PrintGroupPerson_Click方法中	

	导入团体信息
	DHCPEPreGADM.Edit.js
	DHCPEImportGInfo.js中的ReadInfo
	1、检验个人信息是否符合条件
		w ##class(web.DHCPE.ImportGInfo).GetGPersonInfo()
	2、导入数据库数据信息
		w ##class(web.DHCPE.ImportGInfo).Main(4,5888)
	3、导入个人信息
		w ##class(web.DHCPE.ImportGInfo).ImportIADM()



	w##class(web.DHCPE.PreIBIUpdate).Insertperson()



##个人预约信息查询

	zw ##class(%ResultSet).RunQuery("web.DHCPE.Query.IAdmItemStatus", "query","","","64992","","","64992","","")

	点击操作日期
	d ##class(%ResultSet).RunQuery("web.DHCPE.AdmRecordManager", "FindAdmRecord",552)
		
	点击谢绝检查
	DHCPEIAdmItemStatusAdms.js中的Refuse方法中
	w ##class(web.DHCPE.ResultEdit).RefuseCheck("193||4^","")





##退费申请

	w ##class(%ResultSet).RunQuery("web.DHCPE.InvPrt","FindInvPrtList","","","","","64993","64996","","0","","","","")

	点击发票号
	zw ##class(%ResultSet).RunQuery("web.DHCPE.ItemFeeList","FindItemFeeList","","2344","","","","","","","","")

	点击退费单打印
	DHCPEDropItem.js中的BPrint_Click方法中
	w ##class(web.DHCPE.ItemFeeList).GetRefundInfo(2343)

	点击全退审请
	DHCPEDropItem.js中的BRefund_Click方法中
	w ##class("web.DHCPE.Cashier").DropInvPrt()


##客户就餐

	列表
	d ##class(%ResultSet).RunQuery("web.DHCPE.DietManager","SearchIADMDiet","64994","64994","","020000000033","","","")

	点击发饭
	DHCPEDietManager.js中的BSend_click方法中
	DHCPEDietManager.js中的Update方法中
	w ##class(web.DHCPE.DietManager).UpdateDiet("020000000033^","0")

	取消发饭
	DHCPEDietManager.js中的CancelDiet方法中
	w ##class(web.DHCPE.DietManager).CancelDiet("6652","1","1",7058)
	
	登记号回车自动发饭
	DHCPEDietManager.js中的RegNo_KeyDown方法中

	

##赠品管理

	列表
	d ##class(%ResultSet).RunQuery("web.DHCPE.DietManager","SearchIADMGift","64991","64995","","020000000045","0","","")

	点击发送
	DHCPEGiftManager.js中的BSend_click方法中
	w ##class(web.DHCPE.DietManager).UpdateGift("","","")


##允许缴费管理

	w ##class(%ResultSet).RunQuery("web.DHCPE.AllowToCharge","AllowToCharge","","","64994","","","64994","","")

	点击保存
	DHCPEAllowToCharge.js中的Save_Click方法中
	w ##class(web.DHCPE.AllowToCharge).AllowToCharge("6651^1&6693^1&6694^0&6695^0&6696^0&6697^0","Person","ADM")



##收表

	收表结果列表
	d ##class(%ResultSet).RunQuery("web.DHCPE.DHCPEIAdm","SearchGPaperByRecDate","64994","64994","020000000034","","","","","")
	
	在【请确认收表】中录入登记号回车
	DHCPERecPaper.js中的ConfirmRecPaper_KeyDown方法中

	选择送达方式，点击确定
	DHCPEReportDate.js中的BConfirm_click方法中
	w ##class(web.DHCPE.DHCPEIAdm).GetRecPaper("45","2018-12-19","DZB") 
	更新快递地址
	w ##class(web.DHCPE.DHCPEIAdm).UpdateNokAddress("3","www.boe@com.cn")

	勾选【到达未收表】，点击【查询】
	d ##class(%ResultSet).RunQuery("web.DHCPE.DHCPEIAdm","SearchGPaperByRecDate","64994","64994","","on","","","","")

	点击【取消收表】
	DHCPERecPaper.js中的BCancelRecPaper_click方法中
	w ##class(web.DHCPE.DHCPEIAdm).CancelRecPaper("12295")

	收表标志：$d(^DHCPEDataEx("ConfirmRecPaper",PIADM))


##粘贴核对

	输入登记号回车
	DHCPENewBaseInfo.js中的RegNo_keydown方法中

	粘贴
	DHCPENewDiagnosis.js中的SendAudit方法中
	

##粘贴

	列表
	zw ##class(%ResultSet).RunQuery("web.DHCPE.FetchReport","SearchSendAudit","","","","","","","","")

	不能送检原因
	zw ##class(web.DHCPE.DHCPEIAdm).OutNoCheckItemByPAADM("","1",300,2,"0")
		1、取出所有谢绝(放弃)检查的项目：zw ##class(web.DHCPE.ResultEdit).GetRefuseItems("2781")
		2、根据医嘱ID取延期标志、延期日期、延期原因、延期人：w ##Class(web.DHCPE.OrderPostPoned).GetPostPoneInfo("1094||2")



	报告状态
	w ##class("web.DHCPE.FetchReport").OutReportStatus(161)
	
	体检结果
	w ##class("web.DHCPE.FetchReport").OutResultLink(161)



##报告已完成

	zw ##class(%ResultSet).RunQuery("web.DHCPE.FetchReport","SearchCmopleteReport","","","","","on","","")

	点击发送短信
	DHCPESendReportMessage.js中的BSendMessage_click方法中

##取报告

	w ##class(%ResultSet).RunQuery("web.DHCPE.FetchReport","SearchFetchReport","64999","64999","","","","","","","")


##短信发送

	w ##class(%ResultSet).RunQuery("web.DHCPE.SendMessage","FindMessage","","","","0","0","","","117")
	//直接发送短信
	w ##class(web.DHCPE.SendMessage).DirectSenMessage("ReportSendMsg","14959")
##预约管理

	d ##class(%ResultSet).RunQuery("web.DHCPE.PreManager","FindPreManager","")


##个人费用管理

	d ##class(%ResultSet).RunQuery("web.DHCPE.DHCPEIAdm","ICashier","020000000033","","","","")

	审核表对应医嘱明细
	zw ##class(%ResultSet).RunQuery("web.DHCPE.ItemFeeList","FindItemFeeList","","","27115","","","","","","","")


###点击结算

	DHCPEPreAuditPay.js中的BBilled_click方法中
	预结算
	w ##class(web.DHCPE.Cashier).Cashier("")
	真正结算
	w ##class(web.DHCPE.Cashier).RealCashier(1365,4647,"001544^^0^^")





##退费
	
	收费收据列表	
	zw ##class(%ResultSet).RunQuery("web.DHCPE.InvPrt","FindInvPrtList","","","020000000033","","64983","65006","","1","","","","")

	1、点击退费
	DHCPEDropItem.js中的BRefund_Click方法中
	w ##class(web.DHCPE.Cashier).DropInvPrt()、
	//调用第三方退费接口
	w ##class(web.DHCPE.ScanPay.Handler.JDFHandler).RefundTradeOrder("",dropInvId,userId,NetPayInfo)



##体检卡管理

	预交金列表
	zw ##class(%ResultSet).RunQuery("web.DHCPE.APQuery","SearchAdvancePayment","","","","64983","65016","R")

	预交金充值
	DHCPEAdvancePayment.js中BSave_click方法
	w ##class(web.DHCPE.AdvancePayment).UpdateData(1,"^00000007^^R^^N^^^^232^&12212^0000033^1")

	预交金明细列表
	zw ##class(%ResultSet).RunQuery("web.DHCPE.APQuery","SearchAPACDetail","020000000033","","","","","R")
	
	退预交金
	DHCPEAPAC.Refund.js中BRefund_click方法中
	zw ##class(web.DHCPE.AdvancePayment).Refund("120||4^900^10012^1^")


##收费查询

	团检收入报表
	





##录入
	1、输入登记号回车
	DHCPEDocPatient.Find.js中的RegNo_onkeydown方法中
	w ##class(web.DHCPE.DocPatientFind).GetPatientInfo("11","","","0")

	2、已未弃项目
	zw ##class(web.DHCPE.ResultNew).GetNowItemSum()
	点击已体检的数字
	DHCPEDocPatient.Find.js中的ShowHadCheck方法中
	点击未体检的数字
	DHCPEDocPatient.Find.js中的ShowNoCheck方法中
	点击放弃体检的数字
	DHCPEDocPatient.Find.js中的ShowRefuseCheck方法中

	3、点击记录列表
	DHCPEDocPatient.Find.js中的Record_onchange方法中
	DHCPEDocPatient.Tree.js中ShowPage方法中

	4、检查项目列表
	dhcpedocpatient.tree.csp
	w ##class(web.DHCPE.DocPatientFind).GetTreeStr("0^0","665","")

	5、项目具体信息
	zw ##class(web.DHCPE.ResultNew).OutMain("665","2")   //开头正检
	w ##Class(web.DHCPE.ResultNew).OutResultToWeb("665","3","")   //项目具体信息
	zw ##class(web.DHCPE.ResultNew).OutAuditDoc("5","329")  //提交医生、结论建议
	w ##class(web.DHCPE.DocPatientFind).OutEDInfo("5","","329","1") //具体结论信息和建议
	
	6、点击结论
	DHCPENewAdvice.js中的EDClick方法中
	DHCPENewResult.js中CreateEDDetailDiv方法中
	结论信息：zw ##class(web.DHCPE.DHCPEExpertDiagnosis).GetEDInfoByDesc("5","先天性白内障","329")

	7、点击结果
	DHCPENewResult.js中ShowAllResult方法中
	zw ##class(web.DHCPE.ResultDiagnosisNew).OutMain("329","","Y")
	
##总检
	dhcpenewdiagnosis.csp

	登记号回车事件
	DHCPENewBaseInfo.js中的RegNo_keydown方法中
	
	主页面
	W ##Class(web.DHCPE.ResultDiagnosisNew).OutMain("2738","N","")

	总数提交
	DHCPENewDiagnosis.js中的Audit_click方法中

	取消总审
	DHCPENewDiagnosis.js中的StationSCancelSub方法中

	查看小结
	DHCPENewDiagnosis.js中的ShowResult_click方法中

	重新总检
	DHCPENewDiagnosis.js中的SumResult_click方法中

	建议保存
	DHCPENewDiagnosis.js中的Save_click方法中

	建议合并
	DHCPENewDiagnosis.js中的ShowUnite_click方法中

	报告预览
	DHCPENewDiagnosis.js中的PreviewReport方法中

	历史结果
	DHCPENewDiagnosis.js中的GetContrastWithLast方法中

	高危
	DHCPENewDiagnosis.js中的HighRiskReport方法中

	检查报告
	DHCPENewDiagnosis.js中的ShowCheckResult方法中

	检查结论
	DHCPENewDiagnosis.js中的Conclusion方法中

	质量上报
	DHCPENewDiagnosis.js中的QMManager方法中

	返回列表
	DHCPENewDiagnosis.js中的BackList方法中

##体检结果对比

	zw ##class(%ResultSet).RunQuery("web.DHCPE.Report","SearchIADM","020000000092","","","","^A^P^S^","","","","","")

##体检列表

	zw ##class(%ResultSet).RunQuery("web.DHCPE.DocPatientList","FindDocCurrentAdm","")
	

##未总检列表

	d ##class(%ResultSet).RunQuery("web.DHCPE.PreIADM","QueryPEUnAuditAdmInfo","65043","65058","","false","")


##团体报告

	列表
	zw ##class(%ResultSet).RunQuery("web.DHCPE.Report","SearchGReport","","","","","^NA^NoAudit^UNCHECKED^")

##个人报告

	列表
	d ##class(%ResultSet).RunQuery("web.DHCPE.Report","SearchIReport","","","","","^PRINTED^P","","","64983","65009","N","","","","","","QB")
	
	1、导出清单
	          
	DHCPEIReport.js中的ExportPrint_Click方法中
	

##已打报告

	d ##class(%ResultSet).RunQuery("web.DHCPE.PrintIAdmInfo","GetIPrtIAdmInfo","","","")

##科室工作量统计

	d ##class(%ResultSet).RunQuery("web.DHCPE.Report.StationWorkStatistic","StationWorkStatistic","","","","65027","65058","","")


##体检中心工作量统计

	d ##class(%ResultSet).RunQuery("web.DHCPE.Report.LocWork","LocWork","65014","65058")


##科室检查人次统计
	d ##class(%ResultSet).RunQuery("web.DHCPE.Report.LocWorkStatisticByPAADM","LocWorkStatistic","65045","65059","","")

##总检医生工作量统计

	d ##class(%ResultSet).RunQuery("web.DHCPE.Report.GDoctorWorkStatic","GDoctorWorkStatistic","","65059","","")
	已初审人员信息列表
	d ##class(%ResultSet).RunQuery("web.DHCPE.Report.GDoctorWorkInfoList","InfoList","","65059","7058","G","")



##体检日报表

	d ##class(%ResultSet).RunQuery("web.DHCPE.Query.DailyReport","QueryDailyReport")



##体检项目内容
###获取延迟体检和放弃体检的项目

	d ##class(%ResultSet).RunQuery("web.DHCPE.DHCPEIAdm","GetRefuseAndPostPoneItems","2019-01-02","2019-01-02")
	
	DHCRefusePostPoneItems.js

###该项目是否已检

	W ##Class(web.DHCPE.PrintIAdmInfo).CheckRefuse()


##体检相关报表

###体检综合查询

	d ##class(%ResultSet).RunQuery("web.DHCPE.Report.PEPersonStatistic","PEPersonStatistic","")


##科室工作量统计

	d ##class(%ResultSet).RunQuery("web.DHCPE.Report.StationWorkStatistic","StationWorkStatistic","")





##站点与项目组合

	1、更新
	DHCPEStationOrderCom.js中的Update_click()
	d ##class(web.DHCPE.StationOrder).Save